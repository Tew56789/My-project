/**
 * ไฟล์นี้ใช้สำหรับเพิ่มตัวอย่างสูตรอาหารลงใน Firebase
 * 
 * วิธีใช้งาน: 
 * 1. บันทึกไฟล์นี้ไว้ในโปรเจกต์ของคุณ
 * 2. รันคำสั่ง node sample-recipes.js
 * 3. ดูผลลัพธ์ในคอนโซล
 */

const { db } = require('./config/firebase');

// ตัวอย่างข้อมูลสูตรอาหารอีสาน
const sampleRecipes = [
  {
    name: 'ส้มตำไทย',
    description: 'อาหารอีสานยอดนิยม รสชาติเปรี้ยวหวานเผ็ด',
    imageUrl: 'https://img.wongnai.com/p/1920x0/2019/05/15/8c01d0a3eb7c4d479e4f2c3bc0193859.jpg',
    ingredients: [
      'มะละกอขูด 1 ถ้วย',
      'มะเขือเทศ 2 ลูก',
      'ถั่วฝักยาว 4-5 ฝัก',
      'กระเทียม 3-4 กลีบ',
      'พริกขี้หนู 5-10 เม็ด (ตามชอบ)',
      'น้ำตาลปี๊บ 1-2 ช้อนโต๊ะ',
      'น้ำปลา 2 ช้อนโต๊ะ',
      'น้ำมะนาว 2-3 ช้อนโต๊ะ',
      'มะนาว 1 ลูก',
      'ถั่วลิสงคั่ว 2 ช้อนโต๊ะ',
      'กุ้งแห้ง 1 ช้อนโต๊ะ (ถ้ามี)'
    ],
    steps: [
      'โขลกกระเทียมและพริกขี้หนูให้ละเอียด',
      'ใส่มะเขือเทศหั่นชิ้น และถั่วฝักยาวหั่นท่อน ตำพอให้พอแหลก',
      'ใส่มะละกอขูด ตำเบาๆ ให้เข้ากัน',
      'ปรุงรสด้วยน้ำปลา น้ำตาล น้ำมะนาว ชิมให้ได้รสเปรี้ยวหวานเค็มตามชอบ',
      'โรยหน้าด้วยถั่วลิสงคั่ว และกุ้งแห้ง เสิร์ฟพร้อมผักสด'
    ],
    youtubeUrl: 'https://www.youtube.com/watch?v=s2SH7c5JCLk',
    recommended: true,
    created: new Date().toISOString(),
    lastUpdated: new Date().toISOString()
  },
  {
    name: 'ลาบหมู',
    description: 'อาหารอีสานรสจัดจ้าน ทานกับข้าวเหนียวและผักสด',
    imageUrl: 'https://img.wongnai.com/p/1920x0/2020/03/05/ac1d37750c9b4bfebe5ea783e4ae5eb4.jpg',
    ingredients: [
      'เนื้อหมูสับ 300 กรัม',
      'ตับหมู 100 กรัม (ถ้าชอบ)',
      'ข้าวคั่ว 2 ช้อนโต๊ะ',
      'หอมแดงซอย 5-6 หัว',
      'ต้นหอมซอย 3-4 ต้น',
      'ผักชีฝรั่งซอย 2 ต้น',
      'ใบมะกรูดซอย 3-4 ใบ',
      'พริกป่น 1-2 ช้อนโต๊ะ (ตามชอบ)',
      'น้ำปลา 2 ช้อนโต๊ะ',
      'น้ำมะนาว 3-4 ช้อนโต๊ะ',
      'ผงชูรส 1/2 ช้อนชา (ถ้าต้องการ)'
    ],
    steps: [
      'ใส่เนื้อหมูสับและตับหมูลงในหม้อ เติมน้ำพอท่วม ต้มให้สุก',
      'ตักขึ้นใส่ชาม ใส่หอมแดง ต้นหอม ผักชีฝรั่ง และใบมะกรูดซอย',
      'ปรุงรสด้วยน้ำปลา น้ำมะนาว พริกป่น และผงชูรส คลุกให้เข้ากัน',
      'โรยข้าวคั่วลงไป คลุกให้เข้ากันอีกครั้ง',
      'ชิมรสและปรุงเพิ่มตามต้องการ เสิร์ฟพร้อมผักสดและข้าวเหนียว'
    ],
    youtubeUrl: 'https://www.youtube.com/watch?v=tXPQAnN3WCo',
    recommended: true,
    created: new Date().toISOString(),
    lastUpdated: new Date().toISOString()
  },
  {
    name: 'ต้มแซ่บกระดูกหมู',
    description: 'แกงอีสานรสเปรี้ยวเผ็ด หอมสมุนไพร',
    imageUrl: 'https://img.wongnai.com/p/1920x0/2020/07/20/6e62fc98664c4ee2a65b025bc7dc8248.jpg',
    ingredients: [
      'กระดูกหมู 500 กรัม',
      'ตะไคร้ 3 ต้น',
      'ใบมะกรูด 5-6 ใบ',
      'หอมแดง 3-4 หัว',
      'กระเทียม 5-6 กลีบ',
      'ข่าอ่อนหั่นแว่น 5-6 แว่น',
      'พริกขี้หนู 10-15 เม็ด (ตามชอบ)',
      'ผักชีฝรั่ง 2-3 ต้น',
      'ต้นหอม 2-3 ต้น',
      'น้ำปลา 3 ช้อนโต๊ะ',
      'น้ำมะนาว 3-4 ช้อนโต๊ะ',
      'ผงชูรส 1/2 ช้อนชา (ถ้าต้องการ)'
    ],
    steps: [
      'ล้างกระดูกหมูให้สะอาด ต้มในน้ำเดือดจนสุก',
      'ใส่ตะไคร้ทุบ ใบมะกรูดฉีก และข่าหั่นแว่น ต้มต่อให้หอม',
      'ปรุงรสด้วยน้ำปลา',
      'ใส่หอมแดงและกระเทียมลงไป',
      'เมื่อสุกดีแล้ว ปิดไฟ เติมน้ำมะนาว',
      'โรยพริกขี้หนูซอย ผักชีฝรั่ง และต้นหอม',
      'เสิร์ฟร้อนๆ กับข้าวเหนียวและผักสด'
    ],
    youtubeUrl: 'https://www.youtube.com/watch?v=M_JgGIfweSQ',
    recommended: true,
    created: new Date().toISOString(),
    lastUpdated: new Date().toISOString()
  }
];

// ฟังก์ชันเพิ่มตัวอย่างสูตรอาหารลงใน Firebase
async function addSampleRecipes() {
  try {
    console.log('เริ่มเพิ่มสูตรอาหารตัวอย่าง...');
    
    const recipesRef = db.ref('recipes');
    
    // ตรวจสอบว่ามีข้อมูลอยู่แล้วหรือไม่
    const snapshot = await recipesRef.once('value');
    const existingCount = snapshot.numChildren();
    
    console.log(`มีสูตรอาหารในระบบอยู่แล้ว ${existingCount} สูตร`);
    
    if (existingCount > 0) {
      console.log('คุณต้องการเพิ่มสูตรอาหารตัวอย่างเพิ่มเติมหรือไม่? (y/n)');
      // สำหรับการทดสอบเราจะตัดสินใจเลยว่าต้องการเพิ่ม
      const shouldAdd = true;
      
      if (!shouldAdd) {
        console.log('ยกเลิกการเพิ่มสูตรอาหารตัวอย่าง');
        return;
      }
    }
    
    console.log(`กำลังเพิ่มสูตรอาหารตัวอย่าง ${sampleRecipes.length} สูตร...`);
    
    // เพิ่มแต่ละสูตรลงใน Firebase
    for (const recipe of sampleRecipes) {
      const newRecipeRef = recipesRef.push();
      await newRecipeRef.set(recipe);
      console.log(`เพิ่มสูตร "${recipe.name}" เรียบร้อยแล้ว (ID: ${newRecipeRef.key})`);
    }
    
    console.log('เพิ่มสูตรอาหารตัวอย่างเรียบร้อยแล้ว!');
  } catch (error) {
    console.error('เกิดข้อผิดพลาดในการเพิ่มสูตรอาหารตัวอย่าง:', error);
  }
}

// รันฟังก์ชันเพิ่มตัวอย่างสูตรอาหาร
addSampleRecipes().then(() => {
  console.log('เสร็จสิ้นการทำงาน');
  process.exit(0);
}).catch(error => {
  console.error('เกิดข้อผิดพลาด:', error);
  process.exit(1);
});